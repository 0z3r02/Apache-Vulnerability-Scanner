#!/bin/bash

green='\e[1;32m'
stopgreen='\e[m'

clear
echo
echo "  --------------------------------------------- "
echo " |         APACHE VULNERABILITY SCANNER        |"
echo " |            Coded by @rohmatariow            |"
echo "  --------------------------------------------- "

if [ "$1" == '' ];then
	echo " Usage : ./scanner list"
else
	printf " Result :\n"
fi

for target in $(cat $1); do
	curls=$(curl -s -I "http://$target" | grep "Server")
	if [[ "$curls" == *"Apache/2.4.4"* ]];then
		if [[ "$curls" == *"Apache/2.4.49"* ]];then
			echo -e "http://$target" >> Apache2.4.49-PathTraversal
			printf "${green}[!] http://$target VULN PATH TRAVERSAL${stopgreen}\n"
		else
			echo -e "http://$target" >> Apache2.4.4-SSRF
			printf "${green}[!] http://$target VULN SSRF${stopgreen}\n"
		fi
	elif [[ "$curls" == *"Apache/2.4.50"* ]];then
		echo -e "http://$target" >> Apache2.4.50-RCE
		printf "${green}[!] http://$target VULN REMOTE CODE EXECUTION${stopgreen}\n"
	else
		printf "[X] http://$target NOT VULN\n"
	fi
done
